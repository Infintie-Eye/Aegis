<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anxiety Community - Aegis Sanctuary</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/sidebar.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-color: #6a5acd;
            --secondary-color: #87ceeb;
            --accent-color: #9370db;
            --light-color: #e6e6fa;
            --dark-color: #4b0082;
            --text-color: #333;
            --card-bg: rgba(255, 255, 255, 0.85);
            --chat-bg: rgba(255, 255, 255, 0.95);
            --transition: all 0.4s ease;
            --soothing-blue: #a1c4fd;
            --soothing-green: #c2e9fb;
            --soothing-purple: #d4fc79;
        }

        body {
            background: linear-gradient(135deg, #a1c4fd, #c2e9fb, #d4fc79, #96e6a1);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            color: var(--text-color);
            overflow-x: hidden;
            min-height: 100vh;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Sidebar handled by sidebar.css */

        /* Main Content */
        .main-content {
            margin-left: 260px;
            padding: 40px;
            min-height: 100vh;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .header h1 {
            font-size: 2.8rem;
            color: var(--dark-color);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            animation: fadeInDown 1s ease;
        }

        .header p {
            font-size: 1.1rem;
            color: var(--dark-color);
            max-width: 700px;
            margin: 0 auto;
            animation: fadeInUp 1s ease;
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 3D Graphic Element */
        .floating-element {
            position: absolute;
            top: 50px;
            right: 100px;
            width: 200px;
            height: 200px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            box-shadow: 0 10px 30px rgba(106, 90, 205, 0.3);
            transform-style: preserve-3d;
            animation: float 6s ease-in-out infinite;
            z-index: -1;
        }

        .floating-element::before {
            content: '';
            position: absolute;
            top: -20px;
            left: -20px;
            right: -20px;
            bottom: -20px;
            background: linear-gradient(135deg, var(--accent-color), var(--light-color));
            border-radius: 50%;
            z-index: -1;
            filter: blur(20px);
            opacity: 0.7;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotateX(0) rotateY(0); }
            50% { transform: translateY(-20px) rotateX(10deg) rotateY(10deg); }
        }

        /* Chat Container */
        .chat-container {
            display: flex;
            flex: 1;
            gap: 20px;
            margin-top: 20px;
        }

        /* Chat Sidebar */
        .chat-sidebar {
            width: 280px;
            background: var(--card-bg);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
            height: fit-content;
        }

        .chat-sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            opacity: 0;
            z-index: -1;
            transition: var(--transition);
        }

        .chat-sidebar:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .chat-sidebar h3 {
            color: var(--dark-color);
            margin-bottom: 20px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chat-sidebar h3 i {
            color: var(--primary-color);
        }

        .online-users {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .user {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
        }

        .user:hover {
            background: rgba(106, 90, 205, 0.1);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            position: relative;
        }

        .user-status {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4CAF50;
            border: 2px solid white;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            font-weight: 600;
            color: var(--dark-color);
        }

        .user-mood {
            font-size: 0.8rem;
            color: #666;
        }

        /* Chat Main Area */
        .chat-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--chat-bg);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transform-style: preserve-3d;
            position: relative;
        }

        .chat-main::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--soothing-blue), var(--soothing-green));
            opacity: 0.05;
            z-index: -1;
        }

        .chat-header {
            padding: 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .chat-title i {
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        .chat-title h2 {
            color: var(--dark-color);
            font-size: 1.5rem;
        }

        /* Chat Messages */
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            display: flex;
            gap: 12px;
            max-width: 80%;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.own {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            flex-shrink: 0;
        }

        .message-content {
            background: var(--card-bg);
            padding: 12px 16px;
            border-radius: 18px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: relative;
        }

        .message.own .message-content {
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: white;
        }

        .message-text {
            margin-bottom: 5px;
            line-height: 1.4;
        }

        .message-time {
            font-size: 0.7rem;
            opacity: 0.7;
            text-align: right;
        }

        /* Chat Input */
        .chat-input-container {
            padding: 20px;
            border-top: 1px solid rgba(0, 0, 0, 0.05);
        }

        .chat-input {
            display: flex;
            gap: 10px;
        }

        .chat-input-field {
            flex: 1;
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 30px;
            padding: 12px 20px;
            font-size: 1rem;
            outline: none;
            transition: var(--transition);
        }

        .chat-input-field:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(106, 90, 205, 0.1);
        }

        .chat-send-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-color);
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .chat-send-button:hover {
            background: var(--accent-color);
            transform: scale(1.05);
        }

        /* 3D Floating Elements */
        .floating-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .shape {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(106, 90, 205, 0.2), rgba(135, 206, 235, 0.2));
            filter: blur(1px);
            animation: floatShapes 20s infinite ease-in-out;
        }

        @keyframes floatShapes {
            0%, 100% { transform: translateY(0) translateX(0) rotate(0deg); }
            25% { transform: translateY(-20px) translateX(10px) rotate(5deg); }
            50% { transform: translateY(10px) translateX(-10px) rotate(-5deg); }
            75% { transform: translateY(-10px) translateX(5px) rotate(3deg); }
        }

        /* Breathing Exercise Widget */
        .breathing-widget {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
            z-index: 100;
        }

        .breathing-widget:hover {
            transform: scale(1.05);
        }

        .breathing-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            animation: breathe 4s infinite ease-in-out;
        }

        @keyframes breathe {
            0%, 100% { transform: scale(0.8); }
            50% { transform: scale(1.2); }
        }

        /* Breathing Exercise Modal */
        .breathing-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .breathing-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .breathing-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            transform: scale(0.8);
            transition: var(--transition);
        }

        .breathing-modal.active .breathing-content {
            transform: scale(1);
        }

        .breathing-circle-large {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            margin: 30px auto;
            animation: breatheLarge 8s infinite ease-in-out;
        }

        @keyframes breatheLarge {
            0%, 100% { transform: scale(0.7); }
            50% { transform: scale(1.3); }
        }

        .breathing-instruction {
            font-size: 1.5rem;
            color: var(--dark-color);
            margin: 20px 0;
            font-weight: 600;
        }

        .breathing-close {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 10px 20px;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .breathing-close:hover {
            background: var(--accent-color);
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .main-content {
                margin-left: 70px;
            }
            
            .header h1 {
                font-size: 2.4rem;
            }
            
            .floating-element {
                width: 150px;
                height: 150px;
                right: 50px;
            }
            
            .chat-sidebar {
                width: 240px;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                margin-left: 70px;
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .floating-element {
                display: none;
            }
            
            .chat-container {
                flex-direction: column;
            }
            
            .chat-sidebar {
                width: 100%;
                margin-bottom: 20px;
            }
            
            .breathing-widget {
                bottom: 100px;
                right: 20px;
                width: 60px;
                height: 60px;
            }
            
            .breathing-circle {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
        }
    </style>
    <script type="module" src="../js/authguard.js"></script>
</head>
<body>
    <!-- Floating Shapes Background -->
    <div class="floating-shapes">
        <div class="shape" style="width: 80px; height: 80px; top: 10%; left: 5%; animation-delay: 0s;"></div>
        <div class="shape" style="width: 120px; height: 120px; top: 70%; left: 80%; animation-delay: 2s;"></div>
        <div class="shape" style="width: 60px; height: 60px; top: 40%; left: 60%; animation-delay: 4s;"></div>
        <div class="shape" style="width: 100px; height: 100px; top: 20%; left: 70%; animation-delay: 6s;"></div>
        <div class="shape" style="width: 70px; height: 70px; top: 60%; left: 20%; animation-delay: 8s;"></div>
    </div>

    <!-- Sidebar -->
    <div id="sidebar-container"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- 3D Graphic Element -->
        <div class="floating-element"></div>

        <!-- Header -->
        <header class="header">
            <h1>Anxiety Community</h1>
            <p>A safe space to share experiences, find support, and connect with others who understand your journey.</p>
        </header>

        <!-- Chat Container -->
        <div class="chat-container">
            <!-- Chat Sidebar -->
            <div class="chat-sidebar">
                <h3><i class="fas fa-users"></i> Online Members</h3>
                <div class="online-users">
                    <div class="user">
                        <div class="user-avatar">A
                            <div class="user-status"></div>
                        </div>
                        <div class="user-info">
                            <div class="user-name">AnxiousWarrior</div>
                            <div class="user-mood">Feeling hopeful today</div>
                        </div>
                    </div>
                    <div class="user">
                        <div class="user-avatar">C
                            <div class="user-status"></div>
                        </div>
                        <div class="user-info">
                            <div class="user-name">CalmSeeker</div>
                            <div class="user-mood">Need support</div>
                        </div>
                    </div>
                    <div class="user">
                        <div class="user-avatar">P
                            <div class="user-status"></div>
                        </div>
                        <div class="user-info">
                            <div class="user-name">PeacefulMind</div>
                            <div class="user-mood">Having a good day</div>
                        </div>
                    </div>
                    <div class="user">
                        <div class="user-avatar">S
                            <div class="user-status"></div>
                        </div>
                        <div class="user-info">
                            <div class="user-name">SereneSoul</div>
                            <div class="user-mood">Just checking in</div>
                        </div>
                    </div>
                    <div class="user">
                        <div class="user-avatar">B
                            <div class="user-status"></div>
                        </div>
                        <div class="user-info">
                            <div class="user-name">BraveHeart</div>
                            <div class="user-mood">Feeling anxious</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Main Area -->
            <div class="chat-main">
                <div class="chat-header">
                    <div class="chat-title">
                        <i class="fas fa-comments"></i>
                        <h2>Anxiety Support Chat</h2>
                    </div>
                </div>

                <div class="chat-messages" id="chatMessages">
                    <div class="message">
                        <div class="message-avatar">A</div>
                        <div class="message-content">
                            <div class="message-text">Hi everyone, I'm new here. I've been struggling with anxiety for a while and thought it might help to connect with others who understand.</div>
                            <div class="message-time">10:15 AM</div>
                        </div>
                    </div>
                    <div class="message">
                        <div class="message-avatar">P</div>
                        <div class="message-content">
                            <div class="message-text">Welcome AnxiousWarrior! You've come to the right place. This community has been incredibly supportive for me.</div>
                            <div class="message-time">10:17 AM</div>
                        </div>
                    </div>
                    <div class="message">
                        <div class="message-avatar">S</div>
                        <div class="message-content">
                            <div class="message-text">I've been having a tough week with panic attacks. Does anyone have any coping strategies that work for them?</div>
                            <div class="message-time">10:20 AM</div>
                        </div>
                    </div>
                    <div class="message own">
                        <div class="message-avatar">Y</div>
                        <div class="message-content">
                            <div class="message-text">I find that deep breathing exercises help me a lot. There's a breathing exercise widget on this page that I use when I'm feeling overwhelmed.</div>
                            <div class="message-time">10:22 AM</div>
                        </div>
                    </div>
                    <div class="message">
                        <div class="message-avatar">C</div>
                        <div class="message-content">
                            <div class="message-text">Thanks for sharing! I'll try that. Sometimes I feel so alone in this, but talking to all of you helps.</div>
                            <div class="message-time">10:25 AM</div>
                        </div>
                    </div>
                </div>

                <div class="chat-input-container">
                    <div class="chat-input">
                        <input type="text" class="chat-input-field" placeholder="Type your message here..." id="messageInput">
                        <button class="chat-send-button" id="sendButton">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Breathing Exercise Widget -->
    <div class="breathing-widget" id="breathingWidget">
        <div class="breathing-circle">
            <i class="fas fa-wind"></i>
        </div>
    </div>

    <!-- Breathing Exercise Modal -->
    <div class="breathing-modal" id="breathingModal">
        <div class="breathing-content">
            <h2>Guided Breathing Exercise</h2>
            <div class="breathing-circle-large"></div>
            <div class="breathing-instruction" id="breathingInstruction">Breathe In</div>
            <button class="breathing-close" id="breathingClose">Return to Chat</button>
        </div>
    </div>

    <script>
        // DOM Elements
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const chatMessages = document.getElementById('chatMessages');
        const breathingWidget = document.getElementById('breathingWidget');
        const breathingModal = document.getElementById('breathingModal');
        const breathingClose = document.getElementById('breathingClose');
        const breathingInstruction = document.getElementById('breathingInstruction');
        
        // Anonymous usernames for demo
        const anonymousNames = ['AnxiousWarrior', 'CalmSeeker', 'PeacefulMind', 'SereneSoul', 'BraveHeart', 'HopefulSoul', 'MindfulSpirit', 'CourageousHeart'];
        const myUsername = 'You';
        
        // Breathing exercise states
        const breathingStates = ['Breathe In', 'Hold', 'Breathe Out', 'Hold'];
        let currentBreathingState = 0;
        
        // Send message function
        function sendMessage() {
            const messageText = messageInput.value.trim();
            if (messageText === '') return;
            
            // Create message element
            const messageElement = document.createElement('div');
            messageElement.classList.add('message', 'own');
            
            // Get current time
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            // Set message HTML
            messageElement.innerHTML = `
                <div class="message-avatar">Y</div>
                <div class="message-content">
                    <div class="message-text">${messageText}</div>
                    <div class="message-time">${timeString}</div>
                </div>
            `;
            
            // Add message to chat
            chatMessages.appendChild(messageElement);
            
            // Clear input
            messageInput.value = '';
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // Simulate response after a delay
            setTimeout(() => {
                simulateResponse();
            }, 2000);
        }
        
        // Simulate response from another user
        function simulateResponse() {
            const responses = [
                "That's really helpful, thank you for sharing.",
                "I've felt the same way before. You're not alone.",
                "Have you tried talking to a professional about this?",
                "It's okay to feel this way. Be kind to yourself.",
                "I'm here for you. We'll get through this together.",
                "That sounds really difficult. I'm sorry you're going through this.",
                "Have you found any techniques that help you cope?",
                "Thank you for opening up. It takes courage to share."
            ];
            
            const randomUser = anonymousNames[Math.floor(Math.random() * anonymousNames.length)];
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            const userInitial = randomUser.charAt(0);
            
            // Get current time
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            // Create message element
            const messageElement = document.createElement('div');
            messageElement.classList.add('message');
            
            // Set message HTML
            messageElement.innerHTML = `
                <div class="message-avatar">${userInitial}</div>
                <div class="message-content">
                    <div class="message-text">${randomResponse}</div>
                    <div class="message-time">${timeString}</div>
                </div>
            `;
            
            // Add message to chat
            chatMessages.appendChild(messageElement);
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // Event listeners
        sendButton.addEventListener('click', sendMessage);
        
        messageInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        // Breathing exercise functionality
        breathingWidget.addEventListener('click', function() {
            breathingModal.classList.add('active');
            startBreathingExercise();
        });
        
        breathingClose.addEventListener('click', function() {
            breathingModal.classList.remove('active');
            stopBreathingExercise();
        });
        
        // Breathing exercise timer
        let breathingInterval;
        
        function startBreathingExercise() {
            currentBreathingState = 0;
            updateBreathingInstruction();
            
            breathingInterval = setInterval(() => {
                currentBreathingState = (currentBreathingState + 1) % breathingStates.length;
                updateBreathingInstruction();
            }, 2000); // Change state every 2 seconds
        }
        
        function stopBreathingExercise() {
            clearInterval(breathingInterval);
        }
        
        function updateBreathingInstruction() {
            breathingInstruction.textContent = breathingStates[currentBreathingState];
        }
        
        // Navigation handled by sidebar.js
        
        // Interactive Elements
        document.addEventListener('DOMContentLoaded', function() {
            // Create interactive elements that follow the cursor
            const body = document.body;
            
            document.addEventListener('mousemove', function(e) {
                if (Math.random() > 0.95) {
                    createInteractiveElement(e.clientX, e.clientY);
                }
            });
            
            function createInteractiveElement(x, y) {
                const element = document.createElement('div');
                element.classList.add('interactive-element');
                
                const size = Math.random() * 20 + 5;
                element.style.width = `${size}px`;
                element.style.height = `${size}px`;
                element.style.left = `${x - size/2}px`;
                element.style.top = `${y - size/2}px`;
                
                body.appendChild(element);
                
                // Animate the element
                setTimeout(() => {
                    element.style.transform = `scale(${Math.random() * 5 + 2})`;
                    element.style.opacity = '0';
                }, 10);
                
                // Remove the element after animation
                setTimeout(() => {
                    element.remove();
                }, 1000);
            }
        });
    </script>
    <script src="../js/sidebar.js"></script>
</body>
</html>